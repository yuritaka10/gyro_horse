<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#181818">
    <title>gyro horse</title>
    <link rel="stylesheet" href="">
    <link
       rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/destyle.css@1.0.15/destyle.css">
    <link rel="stylesheet" href="css/style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>    <script>// Set a cross-site cookie for third-party contexts
      document.cookie = 'cookie1=value1; SameSite=None; Secure';
      </script>
    <link rel="manifest" href="manifest.webmanifest">
    <link rel="apple-touch-icon" href="images/icons-192.png">

    <script>
    //サービスワーカー
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function() {
        navigator.serviceWorker.register('sw.js').then(function(registration) {
          console.log('ServiceWorker registration successful with scope: ', registration.scope);
        }, function(err) {
          console.log('ServiceWorker registration failed: ', err);
        });
      });
    }
    </script>




</head>
<body>
   <div class="btn">ジャイロセンサーを許可</div>

   <script>
// ジャイロセンサーが使用可能だったら
if(window.DeviceOrientationEvent){
  // ユーザーにアクセスの許可を求める関数があったら（iOS13以降の対応）
  if(DeviceOrientationEvent.requestPermission){
    $(".btn").on("click", function(){
      // ジャイロセンサーへのアクセス許可を申請する
      DeviceOrientationEvent.requestPermission().then(function(response){
        // リクエストが許可されたら
        if(response === "granted"){
        // 回転や傾きの変化を検知する「deviceorientation」を使い、「gyro()」を実行
        $(window).on("deviceorientation", gyro);
        }
      });
    });
    // アクセスの許可を求める関数がなかったら
  }else{
    // 回転や傾きの変化を検知する「deviceorientation」を使い、「gyro()」を実行
    $(window).on("deviceorientation", gyro);
  }
}

       // 値の処理
       function gyro(){
         // それぞれの値の小数点以下を切り捨てて格納
         var beta = Math.floor(event.beta);
         var gamma = Math.floor(event.gamma);
         var alpha = Math.floor(event.alpha);
         // 値を表示
         // X軸（-90~270までの値）X軸は画面横の
         $(".beta span").text(beta);
         // Y軸（-90~90までの値）
         $(".gamma span").text(gamma);
         // Z軸（0~360までの値）
         $(".alpha span").text(alpha);
         // // 傾きアニメーション
         // $(".sensor_img > span").css({transform: 'perspective(1200px) rotateX(' + (-beta) + 'deg) rotateY(' + (-gamma) + 'deg) rotateZ(' + (-alpha) + 'deg)'});
         $(".rotation_x").css({transform: 'perspective(1200px)rotateX(' + (-beta) + 'deg)'});
         $(".rotation_y").css({transform: 'perspective(1200px) rotateY(' + (-gamma) + 'deg)'});
         $(".rotation_z").css({transform: 'perspective(1200px) rotateZ(' + (-alpha) + 'deg)'});
         $(".rotation").css({transform: 'perspective(1200px) rotateX(' + (-beta) + 'deg) rotateY(' + (-gamma) + 'deg) rotateZ(' + (-alpha) + 'deg)'});
         // スマホの向き
         if(beta < 10) {
           $(".roll span").text("横");
         }else{
           $(".roll span").text("縦");
         }
       }

          //画面縦横切り替え
   $(window).resize(function() 
   {
     timer = setTimeout(function() 
     {
       width_display();
     }, 200);
   });

   $(document).ready(function()
   {
     width_display();
   });

   function width_display()
   {
     if (window.innerWidth < window.innerHeight)
     {
       console.log("縦画面");
       // $('body').html
       // (`
       // <div class="btn">ジャイロセンサーを許可</div>
       // ` );

     }
     else if (window.innerWidth > window.innerHeight)
     {
       console.log("横画面");
       // $(".btn").remove();
       $('body').html
       (`
       
       <div class="box">
           <div class="youtube-wrapper" >
             <iframe  src="https://www.youtube-nocookie.com/embed/8mW2QBpQ5HY" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
           </div>

         <div class="bottom-right">
             <ul class="txt">
             <li class="beta">X軸（-90~270までの値）<span>0</span></li>
             <li class="gamma">Y軸（-90~90までの値）<span>0</span></li>
             <li class="alpha">Z軸（0~360までの値）<span>0</span></li>
             <li class="roll">スマホの向き：<span>縦</span></li>
             </ul>
             </div>
         </div>
     `);
     }
   }


 </script>

</body>
</html>